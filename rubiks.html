<!DOCTYPE html>
<html>
<head>
	<title>Rubiks Cube</title>
</head>
<body>
	<script type="text/javascript" src="./three.js"></script>
	<script type="text/javascript" src="./TrackballControls.js"></script>
	<script type="text/javascript">
		var renderer,camera,scene,geometry,material,controls;
		var cubes=[];
		init();
		function init()
		{
		 	renderer = new THREE.WebGLRenderer();
		 	renderer.setSize(window.innerWidth,window.innerHeight);
				document.body.appendChild(renderer.domElement);
		 	camera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1000);
		 	camera.position.z = 150;
		 	scene = new THREE.Scene();
		 	createCubes();
		 	controls = new THREE.TrackballControls(camera);
			controls.rotateSpeed=3.4;
			controls.noZoom=true;
			controls.staticMoving = true;
			controls.dynamicDampingFactor = 0.3;
			//controls.addEventListener('change',render);
		 	animate();
		}

		function createCubes()
		{
			for(i=0;i<27;i++)
			{
				geometry = new THREE.BoxGeometry(8,8,8);
				material = new THREE.MeshBasicMaterial({vertexColors : THREE.FaceColors,overdraw : 0.5});
				geometry.faces[0].color.setRGB(0,1,0); 
				geometry.faces[1].color.setRGB(0,1,0); 
				geometry.faces[2].color.setRGB(1,0,0); 
				geometry.faces[3].color.setRGB(1,0,0); 
				geometry.faces[4].color.setRGB(0.5,0.5,0); 
				geometry.faces[5].color.setRGB(0.5,0.5,0);
				geometry.faces[6].color.setRGB(0,0.5,0.5); 
				geometry.faces[7].color.setRGB(0,0.5,0.5); 
				geometry.faces[8].color.setRGB(0.5,0,0.5); 
				geometry.faces[9].color.setRGB(0.5,0,0.5); 
				geometry.faces[10].color.setRGB(0,0,1); 
				geometry.faces[11].color.setRGB(0,0,1); 
				cubes[i] = new THREE.Mesh(geometry,material);
				if(i>=0&&i<=8)
				{
					cubes[i].position.y = 10;
					geometry.faces[6].color.setRGB(0,0,0); 
					geometry.faces[7].color.setRGB(0,0,0); 
				}
				else if(i>=9&&i<=17)
				{
					cubes[i].position.y = 0;
					geometry.faces[4].color.setRGB(0,0,0); 
					geometry.faces[5].color.setRGB(0,0,0);
					geometry.faces[6].color.setRGB(0,0,0); 
					geometry.faces[7].color.setRGB(0,0,0); 
				}
				else 
				{
					cubes[i].position.y = -10;
					geometry.faces[4].color.setRGB(0,0,0); 
					geometry.faces[5].color.setRGB(0,0,0);
				}
				if(i%3==0)
				{
					cubes[i].position.x = -10;
					geometry.faces[0].color.setRGB(0,0,0); 
					geometry.faces[1].color.setRGB(0,0,0);
				}
				else if(i%3==1)
				{
					cubes[i].position.x = 0;
					geometry.faces[0].color.setRGB(0,0,0); 
					geometry.faces[1].color.setRGB(0,0,0);
					geometry.faces[2].color.setRGB(0,0,0); 
					geometry.faces[3].color.setRGB(0,0,0);
				}
				else
				{
					cubes[i].position.x = 10;
					geometry.faces[2].color.setRGB(0,0,0); 
					geometry.faces[3].color.setRGB(0,0,0);
				}
				if(i%9==0||i%9==1||i%9==2)
				{
					cubes[i].position.z = 0;
					geometry.faces[10].color.setRGB(0,0,0); 
					geometry.faces[11].color.setRGB(0,0,0); 
				}
				else if(i%9==3||i%9==4||i%9==5)
				{
					cubes[i].position.z = -10;
					geometry.faces[8].color.setRGB(0,0,0); 
					geometry.faces[9].color.setRGB(0,0,0); 
					geometry.faces[10].color.setRGB(0,0,0); 
					geometry.faces[11].color.setRGB(0,0,0); 
				}
				else
				{
					cubes[i].position.z = -20;
					geometry.faces[8].color.setRGB(0,0,0); 
					geometry.faces[9].color.setRGB(0,0,0);
				}
				scene.add(cubes[i]);
			}
		}

		document.addEventListener( 'mousedown', onDocumentMouseDown);
		document.addEventListener('mouseup',onDocumentMouseUp)

		function onDocumentMouseDown(event)
		{
			document.addEventListener('mousemove',mouseMove);
			event.preventDefault();
            var raycaster = new THREE.Raycaster(); // create once
            var mouse = new THREE.Vector2(); // create once
            mouse.x = ( event.clientX / renderer.domElement.width ) * 2 - 1;
            mouse.y = - ( event.clientY / renderer.domElement.height ) * 2 + 1;

            raycaster.setFromCamera( mouse, camera );

            var intersects = raycaster.intersectObjects(scene.children,true);
		}

		function onDocumentMouseUp(event)
		{
			document.removeEventListener('mousemove',mouseMove);
		}

		function mouseMove(event)
		{
			console.log(event.clientX);
		}

		function animate()
		{
			window.requestAnimationFrame(animate);
			controls.update();
			render();
		}

		function render()
		{
			renderer.render(scene,camera);
		}
	</script>
</body>
</html>